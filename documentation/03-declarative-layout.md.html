<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>awesome API documentation</title>
    <link rel="stylesheet" href="../ldoc_pale.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>awesome</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#A_simple_layout">A simple layout </a></li>
<li><a href="#Define_widgets_inline_and_place_them">Define widgets inline and place them </a></li>
<li><a href="#Use_an__wibox_layout_align__layout">Use an `wibox.layout.align` layout </a></li>
<li><a href="#Define_new_widgets">Define new widgets </a></li>
<li><a href="#Externally_defined_widgets_and_layouts">Externally defined widgets and layouts </a></li>
<li><a href="#Accessing_widgets">Accessing widgets </a></li>
<li><a href="#Extending_the_system">Extending the system </a></li>
<li><a href="#Handling_sections">Handling sections </a></li>
</ul>


<h2>Documentation</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../documentation/00-authors.md.html">Authors</a></li>
  <li><a href="../documentation/01-readme.md.html">Readme</a></li>
  <li><a href="../documentation/02-contributing.md.html">Contributing</a></li>
  <li><strong>The declarative layout system</strong></li>
  <li><a href="../documentation/04-new-widgets.md.html">Creating new widget</a></li>
</ul>
<h2>Libraries</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../libraries/awesome.html">awesome</a></li>
  <li><a href="../libraries/awful.client.html">awful.client</a></li>
  <li><a href="../libraries/awful.client.shape.html">awful.client.shape</a></li>
  <li><a href="../libraries/awful.completion.html">awful.completion</a></li>
  <li><a href="../libraries/awful.ewmh.html">awful.ewmh</a></li>
  <li><a href="../libraries/awful.hotkeys_popup.html">awful.hotkeys_popup</a></li>
  <li><a href="../libraries/awful.hotkeys_popup.keys.html">awful.hotkeys_popup.keys</a></li>
  <li><a href="../libraries/awful.hotkeys_popup.keys.vim.html">awful.hotkeys_popup.keys.vim</a></li>
  <li><a href="../libraries/awful.hotkeys_popup.widget.html">awful.hotkeys_popup.widget</a></li>
  <li><a href="../libraries/awful.key.html">awful.key</a></li>
  <li><a href="../libraries/awful.keygrabber.html">awful.keygrabber</a></li>
  <li><a href="../libraries/awful.layout.html">awful.layout</a></li>
  <li><a href="../libraries/awful.menu.html">awful.menu</a></li>
  <li><a href="../libraries/awful.mouse.html">awful.mouse</a></li>
  <li><a href="../libraries/awful.placement.html">awful.placement</a></li>
  <li><a href="../libraries/awful.prompt.html">awful.prompt</a></li>
  <li><a href="../libraries/awful.rules.html">awful.rules</a></li>
  <li><a href="../libraries/awful.screen.html">awful.screen</a></li>
  <li><a href="../libraries/awful.spawn.html">awful.spawn</a></li>
  <li><a href="../libraries/awful.tag.html">awful.tag</a></li>
  <li><a href="../libraries/awful.titlebar.html">awful.titlebar</a></li>
  <li><a href="../libraries/awful.tooltip.html">awful.tooltip</a></li>
  <li><a href="../libraries/awful.util.html">awful.util</a></li>
  <li><a href="../libraries/awful.wibox.html">awful.wibox</a></li>
  <li><a href="../libraries/beautiful.html">beautiful</a></li>
  <li><a href="../libraries/beautiful.xresources.html">beautiful.xresources</a></li>
  <li><a href="../libraries/dbus.html">dbus</a></li>
  <li><a href="../libraries/gears.color.html">gears.color</a></li>
  <li><a href="../libraries/gears.debug.html">gears.debug</a></li>
  <li><a href="../libraries/gears.protected_call.html">gears.protected_call</a></li>
  <li><a href="../libraries/gears.shape.html">gears.shape</a></li>
  <li><a href="../libraries/gears.surface.html">gears.surface</a></li>
  <li><a href="../libraries/gears.timer.html">gears.timer</a></li>
  <li><a href="../libraries/gears.wallpaper.html">gears.wallpaper</a></li>
  <li><a href="../libraries/keygrabber.html">keygrabber</a></li>
  <li><a href="../libraries/menubar.html">menubar</a></li>
  <li><a href="../libraries/menubar.menu_gen.html">menubar.menu_gen</a></li>
  <li><a href="../libraries/menubar.utils.html">menubar.utils</a></li>
  <li><a href="../libraries/mouse.html">mouse</a></li>
  <li><a href="../libraries/mousegrabber.html">mousegrabber</a></li>
  <li><a href="../libraries/naughty.html">naughty</a></li>
  <li><a href="../libraries/naughty.dbus.html">naughty.dbus</a></li>
  <li><a href="../libraries/objects.button.html">objects.button</a></li>
  <li><a href="../libraries/objects.client.html">objects.client</a></li>
  <li><a href="../libraries/objects.drawable.html">objects.drawable</a></li>
  <li><a href="../libraries/objects.drawin.html">objects.drawin</a></li>
  <li><a href="../libraries/objects.key.html">objects.key</a></li>
  <li><a href="../libraries/objects.screen.html">objects.screen</a></li>
  <li><a href="../libraries/objects.window.html">objects.window</a></li>
  <li><a href="../libraries/root.html">root</a></li>
  <li><a href="../libraries/selection.html">selection</a></li>
  <li><a href="../libraries/wibox.hierarchy.html">wibox.hierarchy</a></li>
  <li><a href="../libraries/wibox.widget.base.html">wibox.widget.base</a></li>
</ul>
<h2>Classes</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../classes/awful.button.html">awful.button</a></li>
  <li><a href="../classes/awful.widget.button.html">awful.widget.button</a></li>
  <li><a href="../classes/awful.widget.common.html">awful.widget.common</a></li>
  <li><a href="../classes/awful.widget.graph.html">awful.widget.graph</a></li>
  <li><a href="../classes/awful.widget.launcher.html">awful.widget.launcher</a></li>
  <li><a href="../classes/awful.widget.layoutbox.html">awful.widget.layoutbox</a></li>
  <li><a href="../classes/awful.widget.progressbar.html">awful.widget.progressbar</a></li>
  <li><a href="../classes/awful.widget.prompt.html">awful.widget.prompt</a></li>
  <li><a href="../classes/awful.widget.taglist.html">awful.widget.taglist</a></li>
  <li><a href="../classes/awful.widget.tasklist.html">awful.widget.tasklist</a></li>
  <li><a href="../classes/awful.widget.textclock.html">awful.widget.textclock</a></li>
  <li><a href="../classes/awful.widget.watch.html">awful.widget.watch</a></li>
  <li><a href="../classes/button.html">button</a></li>
  <li><a href="../classes/client.html">client</a></li>
  <li><a href="../classes/drawable.html">drawable</a></li>
  <li><a href="../classes/drawin.html">drawin</a></li>
  <li><a href="../classes/gears.cache.html">gears.cache</a></li>
  <li><a href="../classes/gears.matrix.html">gears.matrix</a></li>
  <li><a href="../classes/gears.object.html">gears.object</a></li>
  <li><a href="../classes/key.html">key</a></li>
  <li><a href="../classes/menubar.icon_theme.html">menubar.icon_theme</a></li>
  <li><a href="../classes/menubar.index_theme.html">menubar.index_theme</a></li>
  <li><a href="../classes/screen.html">screen</a></li>
  <li><a href="../classes/signals.html">signals</a></li>
  <li><a href="../classes/tag.html">tag</a></li>
  <li><a href="../classes/wibox.html">wibox</a></li>
  <li><a href="../classes/wibox.drawable.html">wibox.drawable</a></li>
  <li><a href="../classes/wibox.layout.align.html">wibox.layout.align</a></li>
  <li><a href="../classes/wibox.layout.constraint.html">wibox.layout.constraint</a></li>
  <li><a href="../classes/wibox.layout.fixed.html">wibox.layout.fixed</a></li>
  <li><a href="../classes/wibox.layout.flex.html">wibox.layout.flex</a></li>
  <li><a href="../classes/wibox.layout.margin.html">wibox.layout.margin</a></li>
  <li><a href="../classes/wibox.layout.mirror.html">wibox.layout.mirror</a></li>
  <li><a href="../classes/wibox.layout.ratio.html">wibox.layout.ratio</a></li>
  <li><a href="../classes/wibox.layout.rotate.html">wibox.layout.rotate</a></li>
  <li><a href="../classes/wibox.layout.scroll.html">wibox.layout.scroll</a></li>
  <li><a href="../classes/wibox.layout.stack.html">wibox.layout.stack</a></li>
  <li><a href="../classes/wibox.widget.background.html">wibox.widget.background</a></li>
  <li><a href="../classes/wibox.widget.imagebox.html">wibox.widget.imagebox</a></li>
  <li><a href="../classes/wibox.widget.keyboardlayout.html">wibox.widget.keyboardlayout</a></li>
  <li><a href="../classes/wibox.widget.textbox.html">wibox.widget.textbox</a></li>
  <li><a href="../classes/xproperties.html">xproperties</a></li>
</ul>

</div>

<div id="content">

    <h1>The declarative layout system</h1>

<p>This system provide an alternative to the system used in Awesome 3.5 and is
inspired by the one once used by Awesome 3.2-3.4 and Qt QML system.</p>

<p><a name="A_simple_layout"></a></p>

<h2>A simple layout</h2>

<ul>
<li>Display <code>my_first_widget</code> only on screen one</li>
<li>Add a background color to <code>my_third_widget</code></li>
<li>Dispose in a <a href="../classes/wibox.layout.fixed.html#wibox.layout.fixed:horizontal">wibox.layout.fixed.horizontal</a> layout</li>
</ul>


<p>Code:</p>

<pre>
mywibox[s] : setup {
    s == <span class="number">1</span> <span class="keyword">and</span> my_first_widget, <span class="comment">-- Only display on screen 1
</span>    my_second_widget,
    { <span class="comment">-- Add a background color/pattern for my_third_widget
</span>          my_third_widget,
          bg     = beautiful.bg_focus,
          widget = wibox.widget.background,
    },
    layout = wibox.layout.fixed.horizontal,
}
</pre>


<p>In this example <code>s == 1</code> is an inline expression. In the default <code>rc.lua</code>,
there is an <code>s</code> variable represent to define the current screen. Any lua
logic expression can be used as long as it return a valid widget, or a
declarative layout, or <code>nil</code>.</p>

<p><a name="Define_widgets_inline_and_place_them"></a></p>

<h2>Define widgets inline and place them</h2>

<ul>
<li>Create a <a href="../classes/wibox.widget.textbox.html#">wibox.widget.textbox</a> with various properties</li>
<li>Force the textbox size using <a href="../classes/wibox.layout.constraint.html#">wibox.layout.constraint</a></li>
<li>Add a margin around another textbox</li>
<li>Add a <a href="../classes/wibox.widget.background.html#">wibox.widget.background</a> (for visualization)</li>
</ul>


<p>Code:</p>

<pre>
mywibox[s] : setup {
    {
        <span class="comment">-- Force the textbox to always be 300 pixel long
</span>        {
            {
                markup = <span class="string">"&lt;b&gt;Hello World!&lt;/b&gt;"</span>,
                align  = <span class="string">"center"</span>,
                widget = wibox.widget.textbox
            },
            bg     = <span class="string">"#ff0000"</span>,
            widget = wibox.widget.background,
        },
        width    = <span class="number">300</span>,
        strategy = <span class="string">"min"</span>,
        layout   = wibox.layout.constraint
    },
    {
        <span class="comment">-- Add a border around the background
</span>        {
            {
                markup = <span class="string">"Foobar"</span>,
                widget = wibox.widget.textbox
            },
            bg     = <span class="string">"#0000ff"</span>,
            widget = wibox.widget.background
        },
        left   = <span class="number">10</span>,
        right  = <span class="number">10</span>,
        top    = <span class="number">1</span>,
        bottom = <span class="number">2</span>,
        layout = wibox.layout.margin
    },
    layout = wibox.layout.fixed.horizontal,
}
</pre>


<p>Result:
<img src="../images/widgetlayout1.png" alt="Example2 screenshot" /></p>

<p><a name="Use_an__wibox_layout_align__layout"></a></p>

<h2>Use an <a href="../classes/wibox.layout.align.html#">wibox.layout.align</a> layout</h2>

<p>The <a href="../classes/wibox.layout.align.html#">wibox.layout.align</a> is a little different. While most layouts will
ignore any <code>nil</code> lines, the <code>align</code> layout rely on them so <code>left</code>, <code>middle</code>
and <code>right</code> can be defined</p>

<p>Code:</p>

<pre>
mywibox[s] : setup {
    my_textbox1, <span class="comment">-- Left
</span>    <span class="keyword">nil</span>,         <span class="comment">-- Nothing in the middle
</span>    my_textbox2, <span class="comment">-- Right
</span>    layout = wibox.layout.fixed.horizontal,
}
</pre>


<p><a name="Define_new_widgets"></a></p>

<h2>Define new widgets</h2>

<p>New trivial widgets can be created directly in the layout declaration. Here
is a simple circle widget:</p>

<p>Code:</p>

<pre>
mywibox[s] : setup {
    fit    = <span class="keyword">function</span>(self, context, width, height)
        <span class="keyword">return</span> height, height <span class="comment">-- A square taking the full height
</span>    <span class="keyword">end</span>,
    draw   = <span class="keyword">function</span>(self, context, cr, width, height)
        cr:set_source_rgb(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>) <span class="comment">-- Red
</span>        cr:arc(height/<span class="number">2</span>, height/<span class="number">2</span>, height/<span class="number">2</span>, <span class="number">0</span>, <span class="global">math</span>.pi*<span class="number">2</span>)
        cr:fill()
    <span class="keyword">end</span>,
    layout = wibox.widget.base.make_widget,
}
</pre>


<p>Result:
<img src="../images/widgetlayout2.png" alt="Example4 screenshot" /></p>

<p>For more information about how to draw widgets, refer to the <code>Cairo</code> api:</p>

<ul>
<li><a href="http://cairographics.org/manual/cairo-Paths.html">Path</a></li>
<li><a href="http://cairographics.org/manual/cairo-cairo-t.html">Context</a></li>
<li><a href="http://cairographics.org/manual/cairo-cairo-pattern-t.html">Pattern</a></li>
<li><a href="http://cairographics.org/manual/cairo-Transformations.html">transformation</a></li>
<li><a href="http://cairographics.org/operators/">Operator</a></li>
<li><a href="https://developer.gnome.org/pango/stable/">Pango text</a></li>
</ul>


<p><a name="Externally_defined_widgets_and_layouts"></a></p>

<h2>Externally defined widgets and layouts</h2>

<p>This is useful when the widget is provided by an external module or when it
requires complex manipulations which would make the declaration unreadable.</p>

<p>Code:</p>

<pre>
<span class="keyword">local</span> tb = wibox.widget.textbox()
tb:set_markup(<span class="string">"Hello world! "</span>)

<span class="comment">-- Repeat "tb" 3 times
</span>mywibox[s] : setup {
    tb,
    tb,
    tb,
    layout = wibox.layout.fixed.horizontal,
}
</pre>


<p><a name="Accessing_widgets"></a></p>

<h2>Accessing widgets</h2>

<p>For each widget or container, it is possible to add an <code>identifier</code> attribute
so the widget can be accessed later.</p>

<p>Widgets defined using <code>setup</code> can be access by 3 means:</p>

<ul>
<li>Avoid the issue by using externally created widgets</li>
<li>Use <code>my_wibox.my_first_widget.my_second_widget</code> style access</li>
<li>Use JavaScript like <code>my_wibox:get_children_by_id(&quot;my_second_widget&quot;)[1]</code></li>
</ul>


<p>The first method mixes the imperative and declarative syntax, but makes the code
less readable. The second is a little verbose and only works if every node in
the chain have a valid identifier. The last one doesn&rsquo;t require long paths,
but it is not easy to get a specific instance if multiple widgets have the
same identifier.</p>

<p>WARNING: The widget identifier must not use reseved name. This include all
method names, existing widget attributes, <code>layout</code> and <code>widget</code>. Names should
also respect the lua variable name policies (case sensitive, alphanumeric and
underscore characters and non-numeric first character)</p>

<p>Code:</p>

<pre>
mywibox[s] : setup {
    {
        id     = <span class="string">"second"</span>,
        widget = wibox.widget.textbox
    },
    {
        id     = <span class="string">"third"</span>,
        widget = wibox.widget.textbox
    },
    id     = <span class="string">"first"</span>,
    layout = wibox.layout.fixed.horizontal,
}

mywibox[s].first.second:set_markup(<span class="string">"changed!"</span>)
mywibox[s]:get_children_by_id(<span class="string">"third"</span>)[<span class="number">1</span>]:set_markup(<span class="string">"Also changed!"</span>)
</pre>


<p><a name="Extending_the_system"></a></p>

<h2>Extending the system</h2>

<p>This system is very flexible. Each section attribute (the entries with string
keys) is directly linked to the layout or widget API. When setting the
imaginary <code>myproperty</code>, it will first check if <code>set_myproperty</code> exist. If it
doesn&rsquo;t, it will check if there is a <code>myproperty</code> method. Finally, it will
just set the <code>mywidget.myproperty</code> directly in case it is used later or
catched by a lua <code>metatable</code> (operator overload).</p>

<p>Code:</p>

<pre>
<span class="comment">-- "Monkeypatch" a new function to wibox.widget.textbox to add vicious
</span><span class="comment">-- extension support
</span><span class="keyword">function</span> wibox.widget.textbox:vicious(args)
    <span class="keyword">local</span> f = unpack <span class="keyword">or</span> <span class="global">table</span>.unpack <span class="comment">-- Lua 5.1 compat
</span>    vicious.register(w, f(args))
<span class="keyword">end</span>

mywibox[s] : setup {
    {
        vicious = {vicious.widgets.cpu, <span class="string">"CPU: $1%"</span>, <span class="number">3</span>},
        widget  = wibox.widget.textbox
    },
    layout = wibox.layout.fixed.horizontal,
}
</pre>


<p>In this example, the system is extended to that the popular
<a href="http://awesome.naquadah.org/wiki/Vicious">Vicious</a> extension module can be
used directly in the layout declaration. This example will update the textbox
every 3 seconds to show the CPU usage.</p>

<p><a name="Handling_sections"></a></p>

<h2>Handling sections</h2>

<p>The system allows sections to be defined externally, then composed into
the final layout declaration. Here is an example re-using one of the above
example:</p>

<p>Code:</p>

<pre>
<span class="keyword">local</span> circle = {
    fit    = <span class="keyword">function</span>(self, context, width, height)
        <span class="keyword">return</span> height, height <span class="comment">-- A square taking the full height
</span>    <span class="keyword">end</span>,
    draw   = <span class="keyword">function</span>(self, context, cr, width, height)
        cr:set_source_rgb(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>) <span class="comment">-- Red
</span>        cr:arc(height/<span class="number">2</span>, height/<span class="number">2</span>, height/<span class="number">2</span>, <span class="number">0</span>, <span class="global">math</span>.pi*<span class="number">2</span>)
        cr:fill()
    <span class="keyword">end</span>,
    layout = wibox.widget.base.make_widget,
}

<span class="comment">-- Define a layout with the imperative syntax
</span><span class="keyword">local</span> l = wibox.widget.align()

<span class="comment">-- 3 circle
</span>mywibox[s] : setup {
    circle,
    circle,
    circle,
    l,
    layout = wibox.layout.align.horizontal
}

<span class="comment">-- This can be done instead
</span><span class="keyword">local</span> three_circle = {layout = wibox.layout.align.horizontal}
<span class="keyword">for</span> i=<span class="number">1</span>, <span class="number">3</span> <span class="keyword">do</span>
    <span class="global">table</span>.insert(three_circle, circle)
<span class="keyword">end</span>

mywibox[s] : setup (three_circle)
</pre>



</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.3</a></i>
<i style="float:right;">Last updated 2016-03-04 08:32:55 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
