<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Topic 89-NEWS.md - awesome API documentation</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
   <script>
     function show_extra(id) {
        var cur = document.getElementById("item"+id).className

        if (cur == "hide_extra") {
            document.getElementById("item"+id).className = "show_more"
            document.getElementById("button"+id).className = "hide_extra"
        }
     }
   </script>

</head>
<body>

<div id="container">
<div id="main">





<!-- Menu -->

<div id="navigation">
<h1>awesome</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#This_is_work_in_progress_and_describes_the_current_state">This is work in progress and describes the current state </a></li>
<li><a href="#New_features">New features </a></li>
<li><a href="#Noteworthy_fixes">Noteworthy fixes </a></li>
<li><a href="#Behavior_changes">Behavior changes </a></li>
<li><a href="#New_theme_variables">New theme variables </a></li>
<li><a href="#Other">Other </a></li>
<li><a href="#Breaking_changes">Breaking changes </a></li>
</ul>


<h2>Documentation</h2>
<ul class="nowrap">
  <li><a href="../documentation/00-authors.md.html">Authors</a></li>
  <li><a href="../documentation/01-readme.md.html">Readme</a></li>
  <li><a href="../documentation/02-contributing.md.html">Contributing</a></li>
  <li><a href="../documentation/03-declarative-layout.md.html">The Widget system</a></li>
  <li><a href="../documentation/04-new-widgets.md.html">Creating new widget</a></li>
  <li><a href="../documentation/05-awesomerc.md.html">Default configuration file documentation</a></li>
  <li><a href="../documentation/06-appearance.md.html">Change Awesome appearance</a></li>
  <li><a href="../documentation/07-my-first-awesome.md.html">My first Awesome</a></li>
  <li><a href="../documentation/08-client-layout-system.md.html">The AwesomeWM client layout system</a></li>
  <li><a href="../documentation/09-options.md.html">Startup options</a></li>
  <li><a href="../documentation/10-building-and-testing.md.html">Building and Testing</a></li>
  <li><a href="../documentation/16-using-cairo.md.html">Using Cairo and LGI</a></li>
  <li><a href="../documentation/17-porting-tips.md.html">Tips for upgrading your configuration</a></li>
  <li><strong>NEWS</strong></li>
  <li><a href="../documentation/90-FAQ.md.html">FAQ</a></li>
</ul>
<h2>Core components</h2>
<ul class="nowrap">
  <li><a href="../core_components/awesome.html">awesome</a></li>
  <li><a href="../core_components/awful.keygrabber.html">awful.keygrabber</a></li>
  <li><a href="../core_components/client.html">client<span class='listplusign'> and awful.client</span></a></li>
  <li><a href="../core_components/drawable.html">drawable</a></li>
  <li><a href="../core_components/gears.timer.html">gears.timer</a></li>
  <li><a href="../core_components/mousegrabber.html">mousegrabber</a></li>
  <li><a href="../core_components/naughty.action.html">naughty.action</a></li>
  <li><a href="../core_components/naughty.notification.html">naughty.notification</a></li>
  <li><a href="../core_components/root.html">root</a></li>
  <li><a href="../core_components/screen.html">screen<span class='listplusign'> and awful.screen</span></a></li>
  <li><a href="../core_components/tag.html">tag<span class='listplusign'> and awful.tag</span></a></li>
</ul>
<h2>Input handling</h2>
<ul class="nowrap">
  <li><a href="../input_handling/awful.button.html">awful.button</a></li>
  <li><a href="../input_handling/awful.key.html">awful.key</a></li>
  <li><a href="../input_handling/awful.keyboard.html">awful.keyboard</a></li>
  <li><a href="../input_handling/mouse.html">mouse</a></li>
</ul>
<h2>Declarative rules</h2>
<ul class="nowrap">
  <li><a href="../declarative_rules/ruled.client.html">ruled.client</a></li>
  <li><a href="../declarative_rules/ruled.notifications.html">ruled.notifications</a></li>
</ul>
<h2>Widgets</h2>
<ul class="nowrap">
  <li><a href="../widgets/awful.widget.button.html">awful.widget.button</a></li>
  <li><a href="../widgets/awful.widget.clienticon.html">awful.widget.clienticon</a></li>
  <li><a href="../widgets/awful.widget.keyboardlayout.html">awful.widget.keyboardlayout</a></li>
  <li><a href="../widgets/awful.widget.launcher.html">awful.widget.launcher</a></li>
  <li><a href="../widgets/awful.widget.layoutbox.html">awful.widget.layoutbox</a></li>
  <li><a href="../widgets/awful.widget.layoutlist.html">awful.widget.layoutlist</a></li>
  <li><a href="../widgets/awful.widget.prompt.html">awful.widget.prompt</a></li>
  <li><a href="../widgets/awful.widget.taglist.html">awful.widget.taglist</a></li>
  <li><a href="../widgets/awful.widget.tasklist.html">awful.widget.tasklist</a></li>
  <li><a href="../widgets/awful.widget.watch.html">awful.widget.watch</a></li>
  <li><a href="../widgets/naughty.list.actions.html">naughty.list.actions</a></li>
  <li><a href="../widgets/naughty.list.notifications.html">naughty.list.notifications</a></li>
  <li><a href="../widgets/naughty.widget.icon.html">naughty.widget.icon</a></li>
  <li><a href="../widgets/naughty.widget.message.html">naughty.widget.message</a></li>
  <li><a href="../widgets/naughty.widget.title.html">naughty.widget.title</a></li>
  <li><a href="../widgets/wibox.widget.calendar.html">wibox.widget.calendar</a></li>
  <li><a href="../widgets/wibox.widget.checkbox.html">wibox.widget.checkbox</a></li>
  <li><a href="../widgets/wibox.widget.graph.html">wibox.widget.graph</a></li>
  <li><a href="../widgets/wibox.widget.imagebox.html">wibox.widget.imagebox</a></li>
  <li><a href="../widgets/wibox.widget.piechart.html">wibox.widget.piechart</a></li>
  <li><a href="../widgets/wibox.widget.progressbar.html">wibox.widget.progressbar</a></li>
  <li><a href="../widgets/wibox.widget.separator.html">wibox.widget.separator</a></li>
  <li><a href="../widgets/wibox.widget.slider.html">wibox.widget.slider</a></li>
  <li><a href="../widgets/wibox.widget.systray.html">wibox.widget.systray</a></li>
  <li><a href="../widgets/wibox.widget.textbox.html">wibox.widget.textbox</a></li>
  <li><a href="../widgets/wibox.widget.textclock.html">wibox.widget.textclock</a></li>
</ul>
<h2>Widget containers</h2>
<ul class="nowrap">
  <li><a href="../widget_containers/awful.widget.only_on_screen.html">awful.widget.only_on_screen</a></li>
  <li><a href="../widget_containers/naughty.widget.background.html">naughty.widget.background</a></li>
  <li><a href="../widget_containers/wibox.container.arcchart.html">wibox.container.arcchart</a></li>
  <li><a href="../widget_containers/wibox.container.background.html">wibox.container.background</a></li>
  <li><a href="../widget_containers/wibox.container.constraint.html">wibox.container.constraint</a></li>
  <li><a href="../widget_containers/wibox.container.margin.html">wibox.container.margin</a></li>
  <li><a href="../widget_containers/wibox.container.mirror.html">wibox.container.mirror</a></li>
  <li><a href="../widget_containers/wibox.container.place.html">wibox.container.place</a></li>
  <li><a href="../widget_containers/wibox.container.radialprogressbar.html">wibox.container.radialprogressbar</a></li>
  <li><a href="../widget_containers/wibox.container.rotate.html">wibox.container.rotate</a></li>
  <li><a href="../widget_containers/wibox.container.scroll.html">wibox.container.scroll</a></li>
  <li><a href="../widget_containers/wibox.container.tile.html">wibox.container.tile</a></li>
</ul>
<h2>Widget layouts</h2>
<ul class="nowrap">
  <li><a href="../widget_layouts/wibox.layout.align.html">wibox.layout.align</a></li>
  <li><a href="../widget_layouts/wibox.layout.fixed.html">wibox.layout.fixed</a></li>
  <li><a href="../widget_layouts/wibox.layout.flex.html">wibox.layout.flex</a></li>
  <li><a href="../widget_layouts/wibox.layout.grid.html">wibox.layout.grid</a></li>
  <li><a href="../widget_layouts/wibox.layout.manual.html">wibox.layout.manual</a></li>
  <li><a href="../widget_layouts/wibox.layout.ratio.html">wibox.layout.ratio</a></li>
  <li><a href="../widget_layouts/wibox.layout.stack.html">wibox.layout.stack</a></li>
</ul>
<h2>Popups and bars</h2>
<ul class="nowrap">
  <li><a href="../popups_and_bars/awful.hotkeys_popup.widget.html">awful.hotkeys_popup.widget</a></li>
  <li><a href="../popups_and_bars/awful.menu.html">awful.menu</a></li>
  <li><a href="../popups_and_bars/awful.popup.html">awful.popup</a></li>
  <li><a href="../popups_and_bars/awful.titlebar.html">awful.titlebar</a></li>
  <li><a href="../popups_and_bars/awful.tooltip.html">awful.tooltip</a></li>
  <li><a href="../popups_and_bars/awful.wallpaper.html">awful.wallpaper</a></li>
  <li><a href="../popups_and_bars/awful.wibar.html">awful.wibar</a></li>
  <li><a href="../popups_and_bars/awful.widget.calendar_popup.html">awful.widget.calendar_popup</a></li>
  <li><a href="../popups_and_bars/menubar.html">menubar</a></li>
  <li><a href="../popups_and_bars/naughty.layout.box.html">naughty.layout.box</a></li>
  <li><a href="../popups_and_bars/naughty.layout.legacy.html">naughty.layout.legacy</a></li>
  <li><a href="../popups_and_bars/wibox.html">wibox</a></li>
</ul>
<h2>Utility libraries</h2>
<ul class="nowrap">
  <li><a href="../utility_libraries/gears.debug.html">gears.debug</a></li>
  <li><a href="../utility_libraries/gears.filesystem.html">gears.filesystem</a></li>
  <li><a href="../utility_libraries/gears.geometry.html">gears.geometry</a></li>
  <li><a href="../utility_libraries/gears.math.html">gears.math</a></li>
  <li><a href="../utility_libraries/gears.object.html">gears.object</a></li>
  <li><a href="../utility_libraries/gears.protected_call.html">gears.protected_call</a></li>
  <li><a href="../utility_libraries/gears.sort.html">gears.sort</a></li>
  <li><a href="../utility_libraries/gears.string.html">gears.string</a></li>
  <li><a href="../utility_libraries/gears.table.html">gears.table</a></li>
  <li><a href="../utility_libraries/gears.wallpaper.html">gears.wallpaper</a></li>
</ul>
<h2>Theme related libraries</h2>
<ul class="nowrap">
  <li><a href="../theme_related_libraries/beautiful.html">beautiful</a></li>
  <li><a href="../theme_related_libraries/gears.color.html">gears.color</a></li>
  <li><a href="../theme_related_libraries/gears.shape.html">gears.shape</a></li>
</ul>
<h2>Libraries</h2>
<ul class="nowrap">
  <li><a href="../libraries/awful.completion.html">awful.completion</a></li>
  <li><a href="../libraries/awful.hotkeys_popup.html">awful.hotkeys_popup</a></li>
  <li><a href="../libraries/awful.layout.html">awful.layout</a></li>
  <li><a href="../libraries/awful.permissions.html">awful.permissions</a></li>
  <li><a href="../libraries/awful.placement.html">awful.placement</a></li>
  <li><a href="../libraries/awful.prompt.html">awful.prompt</a></li>
  <li><a href="../libraries/awful.rules.html">awful.rules</a></li>
  <li><a href="../libraries/awful.spawn.html">awful.spawn</a></li>
  <li><a href="../libraries/awful.util.html">awful.util</a></li>
  <li><a href="../libraries/dbus.html">dbus</a></li>
  <li><a href="../libraries/gears.matcher.html">gears.matcher</a></li>
  <li><a href="../libraries/gears.surface.html">gears.surface</a></li>
  <li><a href="../libraries/menubar.menu_gen.html">menubar.menu_gen</a></li>
  <li><a href="../libraries/menubar.utils.html">menubar.utils</a></li>
  <li><a href="../libraries/naughty.html">naughty</a></li>
  <li><a href="../libraries/selection.html">selection</a></li>
  <li><a href="../libraries/wibox.widget.html">wibox.widget</a></li>
</ul>
<h2>Sample files</h2>
<ul class="nowrap">
  <li><a href="../sample files/rc.lua.html">rc.lua</a></li>
  <li><a href="../sample files/theme.lua.html">theme.lua</a></li>
</ul>
<h2>Classes</h2>
<ul class="nowrap">
  <li><a href="../classes/awful.widget.common.html">awful.widget.common</a></li>
  <li><a href="../classes/gears.cache.html">gears.cache</a></li>
  <li><a href="../classes/gears.matrix.html">gears.matrix</a></li>
  <li><a href="../classes/menubar.icon_theme.html">menubar.icon_theme</a></li>
  <li><a href="../classes/menubar.index_theme.html">menubar.index_theme</a></li>
  <li><a href="../classes/wibox.hierarchy.html">wibox.hierarchy</a></li>
  <li><a href="../classes/wibox.widget.base.html">wibox.widget.base</a></li>
  <li><a href="../classes/xproperties.html">xproperties</a></li>
</ul>

</div>

<div id="content">

    # NEWS
<p><a name="v44"></a>
# DRAFT Awesome window manager framework version 4.4 changes DRAFT
<p><center> <img src="../images/AUTOGEN_wibox_logo_logo_and_name.svg" /> </center>
<p>## This is work in progress and describes the current state.
<p>Some general text about Awesome v4.4 should be here. Hopefully someone will
notice that it is not yet here before we release...
<p>This document was last updated at commit v4.3-197-g9085ed631.
<p>## New features
<p>* <code>awful.screen</code> now has a <code>request::wallpaper</code> and a
  <code>request::desktop_decoration</code> signal. They make some workflow implementation
  cleaner.
* Lua code can interact with the selection contents via the new
  <code>selection.acquire</code>, <code>selection.getter</code>, and <code>selection.watcher</code> objects
* Pending delayed calls (<a href="../core_components/gears.timer.html#delayed_call">gears.timer.delayed_call</a>) can be dispatched via
  <code>gears.timer.run_delayed_calls_now()</code>
* <a href="../libraries/naughty.html#">naughty</a> was rewritten TODO TODO say more about this TODO TODO
* The <code>rules</code> argument in <a href="../libraries/awful.spawn.html#awful.spawn.once">awful.spawn.once</a> and <code>.single_instance</code> is now
  optional
* The <a href="../widget_containers/wibox.container.background.html#">wibox.container.background</a> now has a <code>border_strategy</code> property to
  define how the content is resized when a border is present.
* The <a href="../widget_containers/wibox.container.margin.html#">wibox.container.margin</a> now allows tables in the <code>margins</code> property.
* The declarative widget syntax now allows to directly use functions instead of
  <code>{widget = myfunction}</code>.
* The <a href="../widgets/awful.widget.tasklist.html#">awful.widget.tasklist</a> now resizes the client icons properly.
* The <a href="../widgets/awful.widget.tasklist.html#">awful.widget.tasklist</a> and <a href="../widgets/awful.widget.taglist.html#">awful.widget.taglist</a> will now set the
  <a href="../core_components/client.html#">client</a> and <a href="../core_components/tag.html#">tag</a> properly respectively on each widget of the template
  automatically. This reduces the amount of boilerplate code.
<p>## Noteworthy fixes
<p>* <code>$SOURCE_DATE_EPOCH</code> is honored in more places when generating the
  documentation
* Fix setting shapes via <a href="../libraries/awful.rules.html#">awful.rules</a>
* Set <code>_NET_WM_DESKTOP</code> for sticky windows correctly
* Under complicated circumstances, AwesomeWM could have run Lua code while
  having the X11 server grabbed. This had the potential to cause deadlocks with
  Lua code using <a href="https://www.lua.org/manual/5.3/manual.html#pdf-io.popen">io.popen</a>. Usage of <a href="https://www.lua.org/manual/5.3/manual.html#pdf-io.popen">io.popen</a> is still strongly discouraged.
* <code>wibox{ input_passthrough = true }</code> now works correctly. Previously, the
  property could only be set on already-constructed wiboxes.
* Remove unused first parameter from multiple widget constructors:
 <a href="../widget_containers/wibox.container.place.html#">wibox.container.place</a>, * <a href="../widget_containers/wibox.container.radialprogressbar.html#">wibox.container.radialprogressbar</a>,
 <a href="../widget_layouts/wibox.layout.stack.html#">wibox.layout.stack</a>,
 <a href="../widgets/wibox.widget.slider.html#">wibox.widget.slider</a>.
* Renamed some properties like <a href="../widgets/wibox.widget.textbox.html#align">wibox.widget.textbox.align</a> to
 <a href="../widgets/wibox.widget.textbox.html#halign">wibox.widget.textbox.halign</a> for consistency reasons.
<p>## Behavior changes
<p>* <a href="../widget_containers/wibox.container.background.html#">wibox.container.background</a> applies shapes differently. The new approach
  should be more consistent with a border.
* The <code>shape_clip</code> option of <a href="../widget_containers/wibox.container.background.html#">wibox.container.background</a> was removed. The code
  now always behaves as if this option is set to <code>true</code>. The old behaviour can
  be simulated with <a href="../widget_layouts/wibox.layout.stack.html#">wibox.layout.stack</a>.
* Awesome now initialises Lua's random number generator from a good source
* <code>naughty.dbus</code> now uses Gio for talking to DBus. This is a first step in the
  deprecation of Awesome's own DBus bindings and could lead to behaviour changes
  on DBus.
* The client <code>keys</code> and <code>buttons</code> property now return <a href="../input_handling/awful.key.html#">awful.key</a>
  and <code>awful.buttons</code> objects rather than the lower level <code>key</code> and <code>button</code>
  objects. If you used these low level APIs to add keys and buttons dynamically,
  please migrate your code to the corresponding <code>:append_</code> and <code>:remove_</code>
  client methods.
 * <code>beautiful.border_width</code> and <code>beautiful.border_color</code> are now honored even
   when the part related to borders is removed from <a href="../sample files/rc.lua.html#">rc.lua</a>. Set them
   appropriately in your theme or disconnect the default <code>request::border</code>
   handler.
 * The order by which the client rules compute the geometry have changed
   slightly. The border is now applied before the titlebar offset. This should
   not affect most users unless you had mitigated the bug it fixes by adding
   the titlebar offset in your rules.
 * Setting <code>awful.rules.rules</code> now append the rules to the existing set.
   Clearing the rules was never officially supported. If you *really* want the
   old behavior, use <code>awful.rules.rules = {}; awful.rules.rules = my_new_rules</code>.
 * <code>client:relative_move()</code> now default <code>nil</code> values to zero. The previous
   behavior made no sense.
 * The tasklist and taglist widgets are no longer directly an instance of
   it's main layout. Use the <code>base_layout</code> property to access the layout.
   This allows to replace the layout at runtime. The previous behavior
   was undocumented.
 * Pango 1.44 is now the oldest recommended Pango version. Older versions are
   still supported, but will lack the ability to use some textbox properties,
   mainly <a href="../widgets/wibox.widget.textbox.html#line_spacing_factor">wibox.widget.textbox.line_spacing_factor</a>.
<p><a name="v43"></a>
# Awesome window manager framework version 4.3 changes
<p>Awesome v4.3 is the third release of the 4.x API. It comes after one and a half
years of little fixes and improvements. Awesome v4.2 was very stable thanks to
everybody's effort to unit test everything. Given no major bug warranted a new
release, this one adds a few large features while preserving full compatibility
with existing user configurations.
<p>## New features
<p> * <a href="../utility_libraries/gears.string.html#">gears.string</a> now has a <code>endswith</code> and <code>startswith</code> functions
 * <code>luarocks</code> modules are now automatically available in Awesome
 * A generic way to create or use widgets has been added
   (<a href="../classes/wibox.widget.base.html#wibox.widget.base.make_widget_from_value">wibox.widget.base.make_widget_from_value</a>)
 * It is now possible to connect to signals from all instances of a widget at once
 * The calendar widget now supports margins
 * The documentation has a new theme
 * Wiboxes now have <code>to_widget()</code> and <code>save_to_svg()</code> methods.
 * The client objects now have a <code>immobilized_horizontal</code> and
   <code>immobilized_vertical</code> property to know if they can currently be moved or
   resized (for example, it is set to false when maximized)
 * <a href="../core_components/gears.timer.html#">gears.timer</a> objects now have a <code>call_now</code> method.
 * The hotkey popup now supports <code>termite</code> keybindings
 * The menubar loads faster
 * Wiboxes have an <code>input_passthrough</code> property to send mouse clicks
   to the object below.
 * The <code>taglist</code> and <code>tasklist</code> now support the declarative constructor syntax
 * There is now an <a href="../core_components/awesome.html#pixbuf_to_surface">awesome.pixbuf_to_surface</a> to convert a <code>GdkPixbuf</code> to
   a cairo surface.
 * The notifications icon can now be resized and limited with
   <code>notification\_icon_\size</code>
 * A <a href="../utility_libraries/gears.sort.html#">gears.sort</a> module has been added with graph resolution
 * <code>awesome-client</code> now runs code in a protected context
 * The <a href="./03-declarative-layout.md.html">widget documentation</a> has
   been extended to be more friendly to new users.
 * There is a new <code>beautiful.maximized_hide_border</code> theme option to hide the
   border for maximized clients.
 * The <a href="../core_components/client.html#">client</a> <code>startup_id</code> field is now writable. This is useful when the
   client native implementation is not present or too buggy to be used.
 * The <a href="../widgets/awful.widget.prompt.html#">awful.widget.prompt</a> now has a <code>with_shell</code> option to allow Bash/ZSH
   aliases, function and environment variables to be used in commands.
 * The <a href="../popups_and_bars/awful.titlebar.html#">awful.titlebar</a>s now have a <code>fallback_name</code> when a client has no <code>name</code>
   property.
 * Clients now have a <code>motif_wm_hints</code> property to reflect some hints using the
   Motif X11 property extension. This is used by some modern toolkits including
   GTK.
 * Clients now have a <code>requests_no_titlebar</code> property to expose when a client
   has client side titlebars (also known as decorations and CSD)
 * The hotkey popup now has a <code>show_awesome_keys</code> option.
 * The <a href="../widgets/awful.widget.prompt.html#">awful.widget.prompt</a> now has more of the <a href="../libraries/awful.prompt.html#">awful.prompt</a> constructor
   arguments.
 * It is now possible to set a list of layouts per tag instead of a single
   global one.
 * There is now a <code>awful.layout.get_tag_layout_index()</code> function to get the
   index of the current layout in the global layout list
   (<a href="../libraries/awful.layout.html#awful.layout.layouts">awful.layout.layouts</a>)
 * The <a href="../widget_layouts/wibox.layout.manual.html#">wibox.layout.manual</a> layout now has an <code>:insert()</code> method.
<p>### Better DPI handling
<p>The screen now has a read/write <code>dpi</code> property and <code>awful.screen.set_auto_dpi_enabled(true)</code>
can be used to automatically set the DPI for many Awesome elements. Please
note that it is not backward compatible and breaks many widget. As AwesomeWM
always used pixels as the de-facto metric for sizes, enabling <code>auto_dpi</code> will
break most existing configs. However, for people who use such setup, it might be
worth speding some time to fix their config.
<p>### Extendable <a href="../libraries/awful.rules.html#">awful.rules</a> providers and better <a href="../libraries/awful.spawn.html#">awful.spawn</a> functions
<p>There is two new functions called <code>awful.rules.add_rule_source</code> and
<code>awful.rules.remove_rule_source</code>. They allow to create a dependency graph
for where a rule comes from and which provider has the priority when setting it.
<p>Previously, there were the normal properties,
<code>awful.rules.high_priority_properties</code> and <code>awful.rules.delayed_properties</code>.
This didn't scale and could not represent all corner cases. Those table still
exist and are still honored, but there is now a system that can handle the full
complexity of the property priority graph.
<p>This is used by default in <a href="../libraries/awful.spawn.html#">awful.spawn</a>. The reliability of attaching
properties to <code>spawn</code> calls has been improved. On top of this, three new
functions were added
<p> * <a href="../libraries/awful.spawn.html#awful.spawn.once">awful.spawn.once</a>
 * <a href="../libraries/awful.spawn.html#awful.spawn.single_instance">awful.spawn.single_instance</a>
 * <a href="../libraries/awful.spawn.html#awful.spawn.raise_or_spawn">awful.spawn.raise_or_spawn</a>
<p>They allow to specify that a command should only have one running instance.
This works across restart too, so all hacks to handle restarting Awesome are
no longer required.
<p>Note that the <a href="../core_components/client.html#startup_id">client.startup_id</a> isn't supported by all applications and a
Linux-specific workaround is recommended to improve the reliability of the
<a href="../libraries/awful.spawn.html#">awful.spawn</a> functions.
<p>### A brand new keygrabber API
<p>The <code>keygrabber</code> module API was rebuilt from scratch to make it more usable.
The previous API was very low level, very close to how it actually work, but
was disconnected from how keygrabbers are used in a window manager. Getting
anything done with the previous API required a lot of boilerplate code and had
many corner cases to handle. The new API has built-in support for the most
common use cases and is fully declarative.
<p>### A new GTK color palette based theme
<p>A new theme has been added. It reads the GTK theme colors and use them in the
<code>wibar</code>, <code>menu</code> and <code>titlebar</code>. It helps create an uniform look and feel
between the window manager and client applications with minimal efforts.
<p>### Widgets improvements
<p>The following widgets have been added:
<p><table class='widget_list' border=1>
 <tr style='font-weight: bold;'>
  <th align='center'>Name</th>
  <th align='center'>Example</th>
 </tr>
<tr>
 <td>
  <a href='../classes/wibox.widget.separator.html'>wibox.widget.separator</a>
 </td>
 <td><img src='../images/AUTOGEN_wibox_widget_defaults_separator.svg' /></td>
</tr>
</table>
<p>It is now possible to set <code>spacing</code> widgets for all layouts:
<p>[![The separator widget](../images/AUTOGEN_wibox_layout_flex_spacing_widget.svg)](../classes/wibox.layout.flex.html#wibox.layout.flex.spacing_widget)
<p>The <a href="../widgets/awful.widget.taglist.html#">awful.widget.taglist</a> and <a href="../widgets/awful.widget.tasklist.html#">awful.widget.tasklist</a> now support creating
custom widgets for each elements:
<p>[![The separator widget](../images/AUTOGEN_wibox_awidget_taglist_indexed.svg)](../classes/wibox.layout.flex.html#wibox.layout.flex.spacing_widget)
<p>[![The separator widget](../images/AUTOGEN_wibox_awidget_tasklist_rounded.svg)](../classes/wibox.layout.flex.html#wibox.layout.flex.spacing_widget)
<p>[![The separator widget](../images/AUTOGEN_wibox_awidget_tasklist_windows10.svg)](../classes/wibox.layout.flex.html#wibox.layout.flex.spacing_widget)
<p>A new <code>popup</code> widget allows to bypass most of the boilerplate code and easily
display widgets on the screen:
<p>[![The ratio strategies](../images/AUTOGEN_awful_popup_wiboxtypes.svg)](../classes/awful.popup.html)
<p>
The <a href="../widgets/awful.widget.layoutlist.html#">awful.widget.layoutlist</a> allows to easily display and select the client
layout from a widget:
<p>[![The layoutbox](../images/AUTOGEN_awful_widget_layoutlist_bar.svg)](../classes/awful.widget.layoutlist.html)
<p>
## Noteworthy fixes
<p> * There is no longer an error when a tag defined by name in <a href="../libraries/awful.rules.html#">awful.rules</a> is
   not found.
 * The menubar is now generally more robust thanks to a variety of improvements
 * Many dead links in the documentation have been fixed
 * The <code>textclock</code> is now generally more robust with formatting issues,
   timezones and declarative constructors.
 * The last screen is never removed. Previously, some laptops removed all screens
   during suspend, causing all clients to go to the first tag or getting lost
   completely.
 * The new default <a href="../sample files/rc.lua.html#">rc.lua</a> uses <code>request::activate</code> to set the focus. This
   fixes many corner case such as unfocusable clients getting the focus.
 * Calling <a href="../libraries/awful.spawn.html#">awful.spawn</a> with a set of properties is now more reliable.
 * <a href="../input_handling/awful.key.html#execute">awful.key.execute</a> is now much more reliable.
<p>## Behavior changes
<p>* Previously, when accessing a screen by RandR output name caused a Lua error
  when no output with the given name exists. This was changed to now return
  <code>nil</code> instead. This could break code that uses <a href="https://www.lua.org/manual/5.3/manual.html#pdf-pcall">pcall</a> to check if a screen
  exists. This code now needs to be changed to check for a <code>nil</code> return instead.
  In practice it is unlikely anyone will notice the difference.
* In the previous release, unfocusable clients might also not be raised.
  It was decided that this is a bug and the default behavior was changed.
<p><a name="v42"></a>
# Awesome window manager framework version 4.2 changes
<p>Awesome v4.2 is the second release of the 4.x API. It mostly fixes the bugs
reported over the last 3 months and adds a couple widgets. Almost 150 issues
have been resolved or decided to be obsolete.
<p>## Noteworthy fixes
<p> * The annoying maximization regression from v4.1 has been fixed
 * Fixes broken drag&drop with some applications like FlowBlade
 * Changing the keyboard layout using <code>xmodmap</code> is now much faster
 * Fixes a regression that prevents Awesome to start when the wallpaper is invalid
 * The client history is now more reliable
 * Another instance where clients ended up in the wrong screen has been fixed
 * Awesome will no longer generate zombie processes when restarted
 * All official themes now support HiDPI screens
 * The <code>magnifier</code> layout has been fixed
 * The menubar has been fixed for Lua 5.1 users
<p>## New features
<p> * The hotkey popup has been extended to support Firefox, Qutebrowser and TMUX
 * Naughty (the notification system) has a new <code>ignore_suspend</code> flag
 * The <code>textclock</code> widget now supports timezones
 * New utility functions have been added:
   * <a href="../utility_libraries/gears.string.html#split">gears.string.split</a>
   * <a href="../utility_libraries/gears.table.html#map">gears.table.map</a>
   * <a href="../utility_libraries/gears.filesystem.html#make_parent_directories">gears.filesystem.make_parent_directories</a>
 * New widget functions (moved out of the <code>gears</code> module):
   * <a href="../libraries/wibox.widget.html#wibox.widget.draw_to_cairo_context">wibox.widget.draw_to_cairo_context</a>
   * <a href="../libraries/wibox.widget.html#wibox.widget.draw_to_svg_file">wibox.widget.draw_to_svg_file</a>
   * <a href="../libraries/wibox.widget.html#wibox.widget.draw_to_image_surface">wibox.widget.draw_to_image_surface</a>
 * Maximization requests from clients can now be intercepted using a
   <code>request::geometry</code> signal handler.
 * A new <a href="../widget_layouts/wibox.layout.manual.html#">wibox.layout.manual</a> layout has been added (see below)
 * Two new <code>calendar</code> widgets have been added, a widget and a popup (see below)
 * The <code>ratio</code> layout now supports various strategies to redistribute space
 * The <code>stack</code> layout now supports offsets
 * The notifications now have a <code>naughty.destroy_all_notifications()</code> function
 * The <code>xresources</code> theme now supports the titlebar <code>hover</code> and <code>press</code> states
<p>The stack layout offsets:
<p>[![The stack offset](../images/AUTOGEN_wibox_layout_stack_offset.svg)](../classes/wibox.layout.stack.html)
<p>The ratio layout new full strategies:
<p>[![The ratio strategies](../images/AUTOGEN_wibox_layout_ratio_strategy.svg)](../classes/wibox.layout.ratio.html)
<p>The <code>manual</code> layout fixes a capability gap where hierarchical elements need to be
placed manually. It has multiple modes including an <a href="../libraries/awful.placement.html#">awful.placement</a> integration.
<p>[![The manual layout](../images/AUTOGEN_wibox_layout_manual_add_at.svg)](../classes/wibox.layout.manual.html)
<p>The new calendar widgets are very flexible and can be themed down to the very small details:
<p>[![The calendar widget](../images/AUTOGEN_wibox_widget_calendar_fn_embed_cell.svg)](../classes/wibox.widget.calendar.html)
[![The calendar widget](../images/AUTOGEN_wibox_widget_calendar_font.svg)](../classes/wibox.widget.calendar.html)
<p>
## Behavior changes
<p> * The client <code>property::floating</code> is now also emitted when the floating
   state changes implicitly, e.g. because the client gets maximized or
   fullscreened.
 * Building Awesome from its root source directory is no longer supported and
   will print an error.
<p><hr />
<p><a name="v41"></a>
# Awesome window manager framework version 4.1 changes
<p>Awesome v4.1 is the first stable release for the Awesome 4.0 API. It adds
non-breaking new features and fixes bugs. The main purpose of the release is to
provide stability while also adding features submitted by our contributors.
This release contains about 350 commits by 35 contributors, including many new
developers. Thanks a lot.
<p>## New features
<p>The shape API has been extended to both client, notifications and wibox.
<p>[![Client geometry](../images/AUTOGEN_wibox_awidget_prompt_highlight.svg)](../libraries/awful.prompt.html)
<p>The prompt now supports syntax highlight and more advanced key hooks.
<p>[![Client geometry](../images/AUTOGEN_wibox_awidget_defaults_prompt.svg)](../libraries/awful.prompt.html)
<p>The prompt widget gained many new themes variables.
<p>[![Client geometry](../images/AUTOGEN_wibox_layout_grid_imperative.svg)](../classes/wibox.layout.grid.html)
<p>There is a new 2D grid layout with rowspan and colspan support.
<p>[![Client geometry](../images/AUTOGEN_wibox_container_defaults_only_on_screen.svg)](../classes/awful.widget.only_on_screen.html)
<p>There is a new <a href="../widget_containers/awful.widget.only_on_screen.html#">awful.widget.only_on_screen</a> container to make it easier to
share wiboxes across multiple screens.
<p>Various documentation improvements. Thanks for the feedbacks.
<p>The <a href="../widgets/awful.widget.taglist.html#">awful.widget.taglist</a> now has <code>volatile</code> theme variables.
<p>There is now extra environment variables such as <code>AWESOME_ICON_PATH</code> and
<code>AWESOME_THEMES_PATH</code> for those who prefer not installing Awesome.
<p>Dynamic "C" Lua libraries are now detected like pure Lua ones.
<p><a href="../core_components/gears.timer.html#">gears.timer</a> gained many new constructor arguments to make it easier to use.
<p>[Input shape](https://awesomewm.org/apidoc/classes/wibox.html#wibox.shape_input)
mask are now supported. It is possible to create a wibox with passthough inputs.
<p>There is a new <a href="../widgets/awful.widget.clienticon.html#">awful.widget.clienticon</a> widget capable of fetching icons of
different sizes.
<p>## New theme variables
<p>This release adds a ton of new theme variables to make Awesome prettier. We also
thank all users who [submitted screenshot](https://github.com/awesomeWM/awesome/issues/1395).
<p>    theme.arcchart_thickness
    theme.enable_spawn_cursor
    theme.fullscreen_hide_border
    theme.hotkeys_bg
    theme.hotkeys_border_colo
    theme.hotkeys_border_width
    theme.hotkeys_description_font
    theme.hotkeys_fg
    theme.hotkeys_font
    theme.hotkeys_group_margin
    theme.hotkeys_label_bg
    theme.hotkeys_label_fg
    theme.hotkeys_modifiers_fg
    theme.hotkeys_shape
    theme.maximized_honor_padding
    theme.notification_bg
    theme.notification_border_color
    theme.notification_border_width
    theme.notification_fg
    theme.notification_font
    theme.notification_height
    theme.notification_margin
    theme.notification_opacity
    theme.notification_shape
    theme.notification_width
    theme.prompt_bg_cursor
    theme.prompt_bg
    theme.prompt_fg_cursor
    theme.prompt_fg
    theme.prompt_font
    theme.taglist_bg_volatile
    theme.taglist_fg_volatile
    theme.taglist_shape_border_color_volatile
    theme.taglist_shape_border_width_volatile
    theme.taglist_shape_volatile
    theme.taglist_spacing
    theme.tasklist_disable_icon
    theme.tasklist_disable_task_name
    theme.titlebar_close_button_focus_hover
    theme.titlebar_close_button_focus_press
    theme.titlebar_close_button_normal_hover
    theme.titlebar_close_button_normal_press
    theme.titlebar_floating_button_focus_active_hover
    theme.titlebar_floating_button_focus_active_press
    theme.titlebar_floating_button_focus_inactive_hover
    theme.titlebar_floating_button_focus_inactive_press
    theme.titlebar_floating_button_normal_active_hover
    theme.titlebar_floating_button_normal_active_press
    theme.titlebar_floating_button_normal_inactive_hover
    theme.titlebar_floating_button_normal_inactive_press
    theme.titlebar_maximized_button_focus_active_hover
    theme.titlebar_maximized_button_focus_active_press
    theme.titlebar_maximized_button_focus_inactive_hover
    theme.titlebar_maximized_button_focus_inactive_press
    theme.titlebar_maximized_button_normal_active_hover
    theme.titlebar_maximized_button_normal_active_press
    theme.titlebar_maximized_button_normal_inactive_hover
    theme.titlebar_maximized_button_normal_inactive_press
    theme.titlebar_minimize_button_focus_hover
    theme.titlebar_minimize_button_focus_press
    theme.titlebar_minimize_button_normal_hover
    theme.titlebar_minimize_button_normal_press
    theme.titlebar_ontop_button_focus_active_hover
    theme.titlebar_ontop_button_focus_active_press
    theme.titlebar_ontop_button_focus_inactive_hover
    theme.titlebar_ontop_button_focus_inactive_press
    theme.titlebar_ontop_button_normal_active_hover
    theme.titlebar_ontop_button_normal_active_press
    theme.titlebar_ontop_button_normal_inactive_hover
    theme.titlebar_ontop_button_normal_inactive_press
    theme.titlebar_sticky_button_focus_active_hover
    theme.titlebar_sticky_button_focus_active_press
    theme.titlebar_sticky_button_focus_inactive_hover
    theme.titlebar_sticky_button_focus_inactive_press
    theme.titlebar_sticky_button_normal_active_hover
    theme.titlebar_sticky_button_normal_active_press
    theme.titlebar_sticky_button_normal_inactive_hover
    theme.titlebar_sticky_button_normal_inactive_press
    theme.wibar_bgimage
    theme.wibar_bg
    theme.wibar_border_color
    theme.wibar_border_width
    theme.wibar_cursor
    theme.wibar_fg
    theme.wibar_height
    theme.wibar_ontop
    theme.wibar_opacity
    theme.wibar_shape
    theme.wibar_stretch
    theme.wibar_type
    theme.wibar_width
<p>## Noteworthy fixes
<p> * Some applications such as VLC and Terminator had large unpainted areas
 * The magnifier layout has been fixed
 * Un-maximization misbehaved
 * Docking area is now per-tag again
 * CMake missing dependencies detection is fixed
 * Support for FreeBSD and OpenBSD have been restored.
 * Dialog and transient window can be moved to other screens again
 * The fallback mode (when Awesome fails to load <a href="../sample files/rc.lua.html#">rc.lua</a>) is now more robust
<p>## Behavior changes
<p>This is a stable release and we tried to minimize any upgrade impact. However
various bugfixes induced minor, not noticeable, changes:
<p> * HiDPI support fix changed the default theme "taglist square". This is only
   true if the original theme file is used (not a copy).
 * Maximization now honor the screen padding. There is an option to restore the
   previous behavior.
 * Un-maximized clients are now restored to their current screen instead of the
   screen where they were maximized.
 * Hotkey popup no longer enable the Vim module by default due to user
   complaints
<p><a href="../libraries/awful.util.html#">awful.util</a> has been split into multiple modules in the <code>gears</code> library to
reduce the dependency graph. This allows for better unit testing. <a href="../libraries/awful.util.html#">awful.util</a>
will be deprecated in Awesome v5. For now, it is still safe to use it. However,
new code should use the functions from <code>gears</code> instead of <a href="../libraries/awful.util.html#">awful.util</a>.
<p>## Other
<p> * The minimal LGI version is now 0.8.0. It was found that Awesome 4.0 also had
   an issue in the menubar module when used with 0.7.3.
 * GTK+3 is now required to run the integration tests.
<p><hr />
<p><a name="v4"></a>
# Awesome window manager framework version 4.0 changes
<p>
Awesome 4.0 is the first release of the v4 API level, breaking the proven
v3.5 API level after 4 years. This requires to port the existing user
configuration and extensions to the new API.
<p>This document offers an overview of the new features and required changes for
existing users.
<p>## New features
<p>### Input
<p>#### Mouse move and resize handlers
<p>The code used to resize and move clients has been refactored to allow plugins
to be attached.  This includes:
<p>* display the client geometry in the wibar
* implement a resize grid
* implement delayed resizing (like Windows 3.11 and TWM)
* have touch-friendly resize handles (implemented by the Collision extension)
* allow window snapping (implemented)
* allow edge tiling (like Windows 7+ (AeroSnap) , KDE and Gnome) (implemented)
* move to the next tag when dragged to the edge (like KDE3) (disabled by default)
<p>**See:**
<p>* <a href="../input_handling/mouse.html#">mouse</a>
* <a href="../core_components/client.html#">client</a> <code>request::geometry</code>
<p>.
<p>##### Edge tiling (AeroSnap)
<p>Clients are now resized when dragged to the screen edge similar to other window
managers. The width of the border can be controlled by the
<code>beautiful.snap_border_width</code> theme variable. The edge shape with
<code>beautiful.snap_shape</code> (see <a href="../theme_related_libraries/gears.shape.html#">gears.shape</a>) and can be disabled by setting
<p>    awful.mouse.snap.edge_enabled = false
<p>##### Edge snapping
<p>While this was already supported, this feature has been extensively extended.
It can be disabled by setting
<p>    awful.mouse.snap.client_enabled = false
<p>#### Hotkey popup
<p>It is now possible to display the list of active keyboard shortcuts by pressing
<code>mod4 + s</code> (<code>hotkeys_popup.show_help</code>).
<p>
**See:**
<p>* <a href="../libraries/awful.hotkeys_popup.html#">awful.hotkeys_popup</a>
* <code>awful.hotkeys_popup.keys</code>
* <code>awful.hotkeys_popup.keys.vim</code>
* <a href="../popups_and_bars/awful.hotkeys_popup.widget.html#">awful.hotkeys_popup.widget</a>
<p>### New tag and layout properties
<p>[![Client geometry](../images/tag_props.svg)](../classes/tag.html)
<p>#### Generic useless gap
<p>Adds an empty space between clients.
<p>**See:**
<p>* <a href="../core_components/tag.html#">tag</a>
* <a href="../core_components/tag.html#gap">tag.gap</a>
* <a href="../core_components/tag.html#gap_single_client">tag.gap_single_client</a>
<p>#### Master fill policies
<p>Allows the layout to optionally take all the space when there is no "slave"
client or to use a smaller screen area. For example, if only one terminal is
present in a <code>awful.layout.suit.tile.left</code> layout, then instead of filling the
whole screen, it wont be larger than it would otherwise be if there were more
clients.
<p>**See:**
<p>* <a href="../core_components/tag.html#">tag</a>
* <a href="../core_components/tag.html#master_fill_policy">tag.master_fill_policy</a>
<p>#### Volatile
<p>Tags can now be <code>volatile</code>. A volatile tag will be destroyed when its last
client has been untagged. This is useful for temporary layouts or tags
dedicated to a single client.
<p>**See:**
<p>* <a href="../core_components/tag.html#volatile">tag.volatile</a>
<p>#### The corner layout
<p>A new client layout with a larger master client and both a vertical and an
horizontal row of slave clients.
<p>### New client properties
<p>* <a href="../core_components/client.html#focusable">client.focusable</a> is now read/write (compared to read only in the previous
  versions)
* <a href="../core_components/client.html#valid">client.valid</a> tells if the client still really exist or if the object is waiting to
  be deleted
* <a href="../core_components/client.html#floating">client.floating</a> is now a client property
* <a href="../core_components/client.html#x">client.x</a> / <a href="../core_components/client.html#y">client.y</a> / <a href="../core_components/client.html#width">client.width</a> / <a href="../core_components/client.html#height">client.height</a> are
  <a href="../core_components/client.html#geometry">client.geometry</a> aliases
* <a href="../core_components/client.html#first_tag">client.first_tag</a> is a convenience wrapper for <code>c:tags()[1]</code>
<p>#### Client signaling
<p>There is now an <a href="../core_components/awesome.html#unix_signal">awesome.unix_signal</a> signal table with all platform specific
signals and their indices. There is also an <code>awesome.kill()</code> function to send
signals to clients. This can be used, among other thing, to pause and resume
clients.
<p>### New client rules (<a href="../libraries/awful.rules.html#">awful.rules</a>)
<p>All of the new client properties can be used in rules. In addition, the
following ones have been added:
<p>* <code>placement</code>: use the <a href="../libraries/awful.placement.html#">awful.placement</a> method (or combinations) to place the
  client. While older version of Awesome allowed to use callbacks here, it
  didn't support all corner cases such as titlebar offsets and border_width.
* <code>titlebars_enabled</code>: older versions of Awesome had a global variable to
  enable or disable titlebars. This is now delegated to the rules.
* <code>new_tag</code>: allows to create a tag for the client instead of using an existing
  one.
* The <a href="../core_components/tag.html#">tag</a> property has been expanded to also find tags from their name.
* The <code>tags</code> property now tries to merge the current tags into the array to fix
  some other properties.
* All geometry properties are now executed at once to avoid side effects.
* The <code>focus</code> is now going through the focus filters instead of being applied
  as-is (see the focus filter section).
<p>#### User rules
<p>It is now possible to register new rules by adding them to some <a href="../libraries/awful.rules.html#">awful.rules</a>
arrays. This can be used by modules to add extra functionalities or to avoid
boilerplate code in callbacks.
<p>* <code>awful.rules.high_priority_properties</code>: before most other rules are executed.
* <code>awful.rules.extra_properties</code>: together with normal rules.
* <code>awful.rules.delayed_properties</code>: after most other rules, but before <code>focus</code>.
<p>Those extra rules also have the capability to mutate the current rule array.
<p>### New widgets
<p>#### Widgets
<p><table class='widget_list' border=1>
 <tr style='font-weight: bold;'>
  <th align='center'>Name</th>
  <th align='center'>Example</th>
 </tr>
<tr>
 <td>
  <a href='../classes/wibox.widget.checkbox.html'>wibox.widget.checkbox</a>
 </td>
 <td><img src='../images/AUTOGEN_wibox_widget_defaults_checkbox.svg' /></td>
</tr>
<tr>
 <td>
  <a href='../classes/wibox.widget.piechart.html'>wibox.widget.piechart</a>
 </td>
 <td><img src='../images/AUTOGEN_wibox_widget_defaults_piechart.svg' /></td>
</tr>
<tr>
 <td>
  <a href='../classes/wibox.widget.progressbar.html'>wibox.widget.progressbar</a>
 </td>
 <td><img src='../images/AUTOGEN_wibox_widget_defaults_progressbar.svg' /></td>
</tr>
<tr>
 <td>
  <a href='../classes/wibox.widget.slider.html'>wibox.widget.slider</a>
 </td>
 <td><img src='../images/AUTOGEN_wibox_widget_defaults_slider.svg' /></td>
</tr>
</table>
<p>#### Containers
<p><table class='widget_list' border=1>
 <tr style='font-weight: bold;'>
  <th align='center'>Name</th>
  <th align='center'>Example</th>
 </tr>
<tr>
 <td>
  <a href='../classes/wibox.container.arcchart.html'>wibox.container.arcchart</a>
 </td>
 <td><img src='../images/AUTOGEN_wibox_container_defaults_arcchart.svg' /></td>
</tr>
<tr>
 <td>
  <a href='../classes/wibox.container.radialprogressbar.html'>wibox.container.radialprogressbar</a>
 </td>
 <td><img src='../images/AUTOGEN_wibox_container_defaults_radialprogressbar.svg' /></td>
</tr>
<p></table>
<p>#### Layouts
<p><table class='widget_list' border=1>
 <tr style='font-weight: bold;'>
  <th align='center'>Name</th>
  <th align='center'>Example</th>
 </tr>
<tr>
 <td>
  <a href='../classes/wibox.layout.ratio.html'>wibox.layout.ratio</a>
 </td>
 <td><img src='../images/AUTOGEN_wibox_layout_defaults_ratio.svg' /></td>
</tr>
<tr>
 <td>
  <a href='../classes/wibox.layout.stack.html'>wibox.layout.stack</a>
 </td>
 <td><img src='../images/AUTOGEN_wibox_layout_defaults_stack.svg' /></td>
</tr>
</table>
<p>Other widgets, like the <code>taglist</code> and <code>tasklist</code>, gained many new
configuration features such as empty colors and shape.
<p>**See:**
<p>* <a href="./03-declarative-layout.md.html">The declarative layout system</a>
* <a href="../widgets/awful.widget.tasklist.html#">awful.widget.tasklist</a>
* <a href="../widgets/awful.widget.taglist.html#">awful.widget.taglist</a>
<p>### New APIs
<p>#### The new and streamlined property system
<p>Previously some core objects, such as clients or tags, were static. It wasn't
possible to directly set new properties on them. This is now supported:
<p>    c.my_new_property = "bar"
<p>Also all properties previously accessible from the <code>awful</code> module are now
directly accessible on the object:
<p>    -- Before
    awful.client.floating.set(c, true)
<p>    -- Now
    c.floating = true
<p>See the "deprecated" section below for the list of functions that have been
replaced by properties or methods.
<p>The widgets API also received a similar overhaul. Both getters/setters and
the property APIs are now supported.
<p>    -- Before
    mytextbox:set_text("Foobar")
    myimagebox:set_resize(not myimagebox:get_resize())
<p>    -- Now
    mytextbox.text = "Foobar"
    myimagebox.resize = not myimagebox.resize
<p>
Awesome 4.0 restores a feature found in older versions of Awesome.
All widgets now have properties again. While all <code>:set_foo(bar)</code> type accessors
are still fully (and forever) supported, it is now possible to do <code>.foo = bar</code>
and <code>obj.foo = not obj.foo</code> . This is supported for all official widgets,
containers and layouts.
<p>#### Declarative widget syntax is supported again
<p>Awesome 4.0 re-introduces the declarative widget syntax. This feature was lost
when Awesome 3.5 introduced the new (and much, much better) widget system. It
is possible to do it again.
<p>**See:**
<p>* <a href="./03-declarative-layout.md.html">The declarative layout system</a>
<p>Most documentation examples have been adapted to use this syntax instead of the
imperative one. Both syntaxes are fully supported.
<p>For example:
<p>    -- Imperative
    local l = wibox.layout.fized.horizontal()
    local i = wibox.widget.imagebox()
    local t = wibox.widget.textbox()
<p>    i:set_image("/path/to/awesomeness.png")
    t:set_text("is awesome")
<p>    l:add(i)
    l:add(t)
<p>    -- Declarative
    local l = wibox.layout {
        {
            image  = "/path/to/awesomeness.png",
            widget = wibox.widget.imagebox
        }.
        {
            text   = "is awesome",
            widget = wibox.widget.textbox
        }.
        layout = wibox.layout.fized.horizontal
    }
<p>
#### The request API
<p>Awesome used to blindly allow requests from clients to steal focus or move
them around. There are now handlers to block such requests.
The <code>request::</code> API is also used internally in Awesome itself to make
previously hard-coded behavior more flexible.
<p>* <code>request::activate</code>: When a client requests focus and/or being raised.
* <code>request::geometry</code>: When a client requests a position.
* <code>request::screen</code>: When a client needs a screen.
* <code>request::select</code>: When a tag wants to be selected.
* <code>request::tag</code>: When a client needs a tag.
* <code>request::titlebars</code>: When a client needs a titlebar.
* <code>request::urgent</code>: When a client requests attention.
<p>**See:**
<p>* <code>awful.ewmh.tag</code>
* <code>awful.ewmh.geometry</code>
* <code>awful.ewmh.activate</code>
* <code>awful.ewmh.urgent</code>
* awful.<code>mouse.resize_handler</code>
<p>The defaults handlers are mostly located in the <code>awful.ewmh</code> module and comply
with what the specification defines.
<p>#### The placement API
<p>[![Shapes](../images/AUTOGEN_awful_placement_maximize.svg)](../libraries/awful.placement.html)
<p>While Awesome already had some basic placement function, the new API makes it
possible to remove most hard-coded geometry handling code. From a user's point
of view this API allows for rich floating window management using
<a href="../libraries/awful.rules.html#">awful.rules</a>.
<p>It provides generic placement functions that work with:
<p>* <a href="../core_components/client.html#">client</a>s
* <a href="../popups_and_bars/wibox.html#">wibox</a>es
* the <a href="../input_handling/mouse.html#">mouse</a>
* anything with a <code>:geometry()</code> method
<p>**See:**
<p>* <a href="../libraries/awful.placement.html#">awful.placement</a>
<p>#### The shape API
<p>[![Shapes](../images/AUTOGEN_gears_shape_partially_rounded_rect.svg)](../libraries/gears.shape.html)
<p>This new API allows nicer visuals and more complex themes.
<p>
Also note that the client shape functionality was broken in 3.5 and has been
fixed.
**See:**
<p>* <a href="../theme_related_libraries/gears.shape.html#">gears.shape</a>
<p>#### The hierarchy API
<p>The widget framework now produces a persistent model of its content rather than
a volatile one during the wibox drawing. This allows for better introspection
into the widget tree.
This model is now exposed through the <code>mouse::enter</code>, <code>mouse::press</code>,
<a href="../input_handling/mouse.html#current_widget">mouse.current_widget</a> and other APIs. This tree model also includes various
matrices to convert positions from the screen coordinates to the one of the
widgets (think of scaling and rotations).
<p>This allows for interactive widgets such as a slider.
<p>**See:**
<p>* <a href="../classes/wibox.hierarchy.html#">wibox.hierarchy</a>
* <a href="./04-new-widgets.md.html">Creating new widget</a>
<p>### New themes
<p>A new <code>xresources</code> theme has been added. It uses native X11 assets such as
colors.
<p>The default theme was improved with a more modern looking icon set.
<p>### Spawn and launcher improvements
<p>#### Spawn
<p>The newly renamed <a href="../libraries/awful.spawn.html#">awful.spawn</a> (previously <code>awful.util.spawn</code>) has been
extended into a whole API. It is now possible to define rules directly through
the spawn function.
Note that this only works if the client properly supports the freedesktop.org
startup notifications protocol. For example, to open a new <code>urxvt</code> in a new tag
from the command line, use:
<p>
    awesome-client  "require('awful.spawn')('urxvt', {new_tag=true})"
<p>
As another example, to launch a centered floating terminal in the currently
selected tag of screen number 2:
<p>
    awful.spawn("urxvt", {
        tag       = screen[2].selected_tag,
        placement = awful.placement.centered,
        floating  = true
    })
<p>**See:**
<p>* <a href="../libraries/awful.spawn.html#">awful.spawn</a>
* <a href="../libraries/awful.rules.html#">awful.rules</a>
<p>All rule properties can be used, including the newly introduced placement ones
(like above).
<p>#### Launcher
<p><a href="../libraries/awful.prompt.html#">awful.prompt</a> gained many new features. One of them is the ability to add
custom keyboard shortcuts and mutate the command.
Paired with the new spawn features, it can be used to create <code>mod4 + r</code>
shortcuts to spawn the clients with arguments and callbacks.
<p>**See:**
<p>* <a href="../libraries/awful.prompt.html#">awful.prompt</a>
<p>### Focus stealing filters.
<p>It is now possible to add and manage filters to restrict what kind of focus
stealing is allowed. It can be used to mute noisy applications or to implement
tag level policies.
Every way a client could claim focus, including those from within Awesome
itself, now goes through the request filters.
<p>**See:**
<p>* <code>awful.ewmh.add_activate_filter</code>
* <code>awful.ewmh.remove_activate_filter</code>
* <code>awful.ewmh.activate</code>
<p>### Notification actions
<p>Awesome now supports XDG notification (aka, naughty) actions.
<p>**See:**
<p>* <a href="../libraries/naughty.html#">naughty</a>
<p>### Custom xproperties support
<p>Awesome can now save some data in the X11 server itself. This allows to
communicate with external applications or so save state across restarts.
<p>There is also supported/used for persistent client properties.
<p>### Better XKB keyboard layout support
<p>Awesome now has native support for keyboard layout detection and setting. Using
<code>setxkbmap</code> to track the current layout is no longer necessary. This also
includes a widget to view the current layout.
<p>**See:**
<p>* <a href="../core_components/awesome.html#xkb_set_layout_group">awesome.xkb_set_layout_group</a>
* <a href="../core_components/awesome.html#xkb_get_layout_group">awesome.xkb_get_layout_group</a>
* <a href="../core_components/awesome.html#xkb_get_group_names">awesome.xkb_get_group_names</a>
* <code>wibox.widget.keyboardlayout</code>
<p>### Other minor features
<p>* <a href="../core_components/awesome.html#composite_manager_running">awesome.composite_manager_running</a> allows to detect if a compositor is
  running
* a new <code>--replace</code> command line option is available (similar to other window
  managers)
* clients now have an unified <code>maximized</code> property additionally to only
  _horizontal and _vertical
* <a href="../libraries/awful.layout.html#awful.layout.layouts">awful.layout.layouts</a> is now where the client layout array is stored
* the <code>systray</code> elements order can be reversed and spacing can be added
* it is now possible to get the layout of unselected tags (use with caution)
* tags can be swapped, former XMonad users with multiple screens can rejoice
* whole screens can now be swapped
* virtual screens can be created, moved and resized
* paths can be added to Lua's search path via the <code>--search</code> argument
* RandR 1.5 MONITOR support
* access to the X resource management database
* titlebars are now controlled using <a href="../libraries/awful.rules.html#">awful.rules</a> and enabled by default
* <code>awesome-client</code> now supports Lua code as its first argument (instead of
  reading from stdin)
* preferred client icon size can now be configured (see
  <a href="../core_components/awesome.html#set_preferred_icon_size">awesome.set_preferred_icon_size</a>)
* there is now an <a href="../core_components/awesome.html#startup_errors">awesome.startup_errors</a> string with the startup error (if
  any)
* Initial support for HiDPI monitors / different DPI per screen
* early support for stateful client layouts
* the <code>--version</code> command line option now provides more details and system
  information
<p>## Breaking changes
<p>Awesome 4.0 is a major release.
As with all other major release, the API was broken to accommodate for new
capabilities. It isn't as different as 3.5 was from 3.4 however.
Many changes now cause a deprecation warning instead of breaking hard.
However, it is important to take note of these changes in order to avoid new
bugs.
<p>Also see the <a href="17-porting-tips.md.html#v4">tips for porting your
configuration</a>.
<p>### There can be off-screen clients unless rc.lua is adapted
<p>
**To fix from bash/zsh without a config change:**
<p>    echo 'for _,c in ipairs(client.get()) do require("awful.placement").no_offscreen(c) end' | awesome-client
<p>And add the following to the global rc.lua <code>awful.rule</code> section:
<p>    placement = awful.placement.no_overlap+awful.placement.no_offscreen
<p>Also note that this is the new official syntax for placement functions in
rules. It is recommended to remove existing ones that are used as callbacks and
move them to the <code>placement</code> rule property.
<p>**See:**
<p>* <a href="../libraries/awful.placement.html#">awful.placement</a>
* <a href="../libraries/awful.placement.html#awful.placement.no_overlap">awful.placement.no_overlap</a>
* <a href="../libraries/awful.placement.html#awful.placement.no_offscreen">awful.placement.no_offscreen</a>
* <a href="../libraries/awful.rules.html#">awful.rules</a>
<p>### Screens are no longer static
<p>Replace rc.lua <code>for s=1, screen.count() do</code> with
<code>awful.screen.connect_for_each_screen(function(s)</code> and add a <code>)</code> after the
section <code>end</code>.
All global widget tables should be adapted to avoid memory leaks.
Static code should not use <code>screen.count()</code> anymore. It should also always use
the screen object, as the integer representation is mostly deprecated.
<p>**See:**
<p>* <a href="../core_components/screen.html#">screen</a>
* <a href="../core_components/screen.html#awful.screen.connect_for_each_screen">screen.connect_for_each_screen</a>
* <a href="../core_components/screen.html#awful.screen.disconnect_for_each_screen">screen.disconnect_for_each_screen</a>
<p>### Screens are now objects
<p>Previously: <code>type(s) == &quot;number&quot;</code>, now: <code>type(s) == &quot;screen&quot;</code>.
Doing <code>screen[1].geometry</code> is now partially deprecated and will probably print
a warning in future versions. Any code comparing number and screen objects is
now broken. Use screen objects instead of numbers.
<p>**See:**
<p>* <a href="../core_components/screen.html#">screen</a>
<p>### Awesome no longer restarts when a new screen is added
<p>By default, <a href="../sample files/rc.lua.html#">rc.lua</a> now handles screen changes without restarting.
It allows to preserve the tag and layout state across changes. Old <a href="../sample files/rc.lua.html#">rc.lua</a> can
either be ported to handle this by taking clues from the new <a href="../sample files/rc.lua.html#">rc.lua</a> or
restore the old behavior by adding the following at the end:
<p>    screen.connect_signal("list", awesome.restart)
<p>**See:**
<p>* <a href="../core_components/screen.html#">screen</a>
* <a href="../core_components/screen.html#list">screen.list</a>
<p>
### Widgets' <code>:fit()</code> and <code>:draw()</code> methods signature changed and <code>:layout()</code> is mandatory for layouts and containers
<p>All custom widgets need to change their function signature.
<p>### The "align" layout default behavior changes
<p>There is a new "strategy" property to define how the space is distributed.
<p>### Many APIs are deprecated, fix them before they turn into errors
<p>For example, instead of <code>awful.tag.viewonly(t)</code>, the recommended API is now
<code>t:view_only()</code>. The whole API has been standardized around this object
oriented notation. The warnings will be printed on stderr.
<p>### Most widgets' private APIs have changed
<p>You should not use undocumented APIs. Those can change at any time, and this
is no exception. The private API of all widgets has been broken.
<p>### Spawn changes
<p>* It has been moved into its own module (<a href="../libraries/awful.spawn.html#">awful.spawn</a>).
* Some methods have been deprecated. It is not recommended to use blocking
  methods in Awesome. We made sure to make your life harder if you wish to
  ignore this warning.
  Really, using blocking calls in rc.lua has very nasty side effects.
<p>
**See:**
<p>* <a href="../libraries/awful.spawn.html#">awful.spawn</a>
<p>### Prompt changes
<p>Most arguments have been deprecated, they are now taken from the <code>args</code>
argument-by-name table. This was done because the number of optional arguments
was getting out of control.
<p>
**See:**
<p>* <a href="../libraries/awful.prompt.html#awful.prompt.run">awful.prompt.run</a>
<p>### Timers are no longer part of the C API
<p>Use <a href="../core_components/gears.timer.html#">gears.timer</a>.
<p>### Deprecated functions
<p>The previous Awesome API mixed different conventions. There was a major
undertaking in 4.0 to make the API coherent and well documented.
<p>Those functions have been renamed or converted to methods:
<p>* awful.<a href="../core_components/client.html#awful.client.urgent.jumpto">client.jumpto</a>
* awful.<a href="../core_components/client.html#awful.client.visible">client.visible</a>
* awful.<a href="../core_components/client.html#awful.client.tiled">client.tiled</a>
* awful.<a href="../core_components/client.html#awful.client.moveresize">client.moveresize</a>
* awful.<a href="../core_components/client.html#awful.client.movetotag">client.movetotag</a>
* awful.<a href="../core_components/client.html#awful.client.toggletag">client.toggletag</a>
* awful.<a href="../core_components/client.html#awful.client.movetoscreen">client.movetoscreen</a>
* awful.<a href="../core_components/client.html#awful.client.mark">client.mark</a>
* awful.<a href="../core_components/client.html#awful.client.unmark">client.unmark</a>
* awful.<a href="../core_components/client.html#awful.client.ismarked">client.ismarked</a>
* awful.<a href="../core_components/client.html#awful.client.togglemarked">client.togglemarked</a>
* awful.<code>client.floating.set</code>
* awful.<a href="../core_components/client.html#awful.client.isfixed">client.isfixed</a>
* awful.<code>client.floating.get</code>
* awful.<code>client.floating.toggle</code>
* awful.<code>client.dockable.get</code>
* awful.<code>client.dockable.set</code>
* awful.<code>client.property.get</code>
* awful.<code>client.property.set</code>
* awful.<a href="../core_components/client.html#get_transient_for_matching">client.get_transient_for_matching</a>
* awful.<a href="../core_components/client.html#is_transient_for">client.is_transient_for</a>
* awful.<a href="../input_handling/mouse.html#awful.mouse.client_under_pointer">mouse.client_under_pointer</a>
* awful.<code>mouse.client.dragtotag.border</code>
* awful.<code>mouse.client.corner</code>
* awful.<a href="../core_components/screen.html#awful.screen.getdistance_sq">screen.getdistance_sq</a>
* awful.<a href="../core_components/screen.html#padding">screen.padding</a>
* awful.<a href="../core_components/tag.html#awful.tag.move">tag.move</a>
* awful.<a href="../core_components/tag.html#swap">tag.swap</a>
* awful.<a href="../core_components/tag.html#delete">tag.delete</a>
* awful.<a href="../core_components/tag.html#awful.tag.gettags">tag.gettags</a>
* awful.<a href="../core_components/tag.html#awful.tag.setscreen">tag.setscreen</a>
* awful.<a href="../core_components/tag.html#awful.tag.getscreen">tag.getscreen</a>
* awful.<a href="../core_components/tag.html#awful.tag.selectedlist">tag.selectedlist</a>
* awful.<a href="../core_components/tag.html#selected">tag.selected</a>
* awful.<a href="../core_components/tag.html#awful.tag.setmwfact">tag.setmwfact</a>
* awful.<a href="../core_components/tag.html#awful.tag.getmwfact">tag.getmwfact</a>
* awful.<a href="../core_components/tag.html#awful.tag.setlayout">tag.setlayout</a>
* awful.<a href="../core_components/tag.html#awful.tag.setvolatile">tag.setvolatile</a>
* awful.<a href="../core_components/tag.html#awful.tag.getvolatile">tag.getvolatile</a>
* awful.<a href="../core_components/tag.html#awful.tag.setgap">tag.setgap</a>
* awful.<a href="../core_components/tag.html#awful.tag.getgap">tag.getgap</a>
* awful.<a href="../core_components/tag.html#awful.tag.setmfpol">tag.setmfpol</a>
* awful.<a href="../core_components/tag.html#awful.tag.getmfpol">tag.getmfpol</a>
* awful.<a href="../core_components/tag.html#awful.tag.setnmaster">tag.setnmaster</a>
* awful.<a href="../core_components/tag.html#awful.tag.getnmaster">tag.getnmaster</a>
* awful.<a href="../core_components/tag.html#awful.tag.seticon">tag.seticon</a>
* awful.<a href="../core_components/tag.html#awful.tag.geticon">tag.geticon</a>
* awful.<a href="../core_components/tag.html#awful.tag.setncol">tag.setncol</a>
* awful.<a href="../core_components/tag.html#awful.tag.getncol">tag.getncol</a>
* awful.<a href="../core_components/tag.html#awful.tag.getidx">tag.getidx</a>
* awful.<a href="../core_components/tag.html#awful.tag.viewonly">tag.viewonly</a>
* awful.<a href="../core_components/tag.html#awful.tag.getdata">tag.getdata</a>
* awful.<a href="../core_components/tag.html#awful.tag.getproperty">tag.getproperty</a>
* awful.<a href="../core_components/tag.html#awful.tag.setproperty">tag.setproperty</a>
* awful.<a href="../core_components/tag.html#awful.tag.withcurrent">tag.withcurrent</a>
* <a href="../libraries/awful.util.html#awful.util.get_rectangle_in_direction">awful.util.get_rectangle_in_direction</a>
* <code>awful.wibox.get_position</code>
* <code>awful.wibox.set_position</code>
* <code>awful.wibox.attach</code>
* <code>awful.wibox.align</code>
* <code>awful.wibox.stretch</code>
* <code>awful.widget.progressbar.set_vertical</code>
* <code>awful.widget.progressbar.set_height</code>
* <code>awful.widget.progressbar.set_width</code>
<p>Note that for 4.0, only a warning will be printed if these functions are used.
They will eventually be removed.
<p>### Increased use of asynchronous programming
<p>Many operations, such as re-draw, re-layout, geometry changes and various C API
calls are now delayed to the end of the event loop iteration to avoid multiple
changes per iteration (to not waste CPU time).
The downside of this is that it is no longer reliable to assume the result of
the previous line of code being applied in the next already.
<p>### Startup handling
<p>There is no longer a "startup" argument to the client "manage" signal. If
Awesome is currently starting up, then <a href="../core_components/awesome.html#startup">awesome.startup</a> is set to <code>true</code>.
<p>### Renamed modules
<p>Just as the functions above, many modules have been moved to follow a naming
convention.
Using the old name will print a warning and will alias into the new module.
Note that theses aliases are temporary and will be removed.
<p>* <code>awful.wibox</code>
* <code>awful.widget.graph</code>
* <code>awful.widget.progressbar</code>
* <code>awful.widget.textclock</code>
* <code>wibox.layout.constraint</code>
* <code>wibox.layout.margin</code>
* <code>wibox.layout.mirror</code>
* <code>wibox.layout.rotate</code>
* <code>wibox.layout.scroll</code>
* <code>wibox.widget.background</code>
<p>### The mouse finder module is gone
<p>It has been broken for ages, so we concluded nobody cared.
<p>### Menubar changes
<p><a href="../libraries/menubar.menu_gen.html#menubar.menu_gen.generate">menubar.menu_gen.generate</a> is now asynchronous and needs a callback as an
argument.
<p>### Rules execution order changes
<p>The order in which rules are executed changed.
It has been manually curated to avoid known race conditions between the rules
execution. For example, adding a titlebar after setting the position resulted
in an unwanted shift proportional to the titlebar size.
<p>This is regarded as a breaking changes since it impacts the behavior of
existing code, hopefully for the better.
<p>## Other
<p>### New dependencies
<p>Awesome now depends on Gio and a few other new packages since 3.5.
See the README for an extensive list.
<p>### A new documentation
<p>Awesome 4.0 now uses LDoc and MarkDown based documentation. We also introduced
official guides into our documentation:
<p>* <a href="./90-FAQ.md.html">FAQ</a>
* <a href="./02-contributing.md.html">Contributing</a>
* <a href="./03-declarative-layout.md.html">The declarative layout system</a>
* <a href="./04-new-widgets.md.html">Creating new widget</a>
* <a href="./05-awesomerc.md.html">Default configuration file documentation</a>
* <a href="./06-appearance.md.html">Change Awesome appearance</a>
* <a href="./16-using-cairo.md.html">Using Cairo and LGI</a>
<p>The new documentation is vastly superior to the previous one and includes
previously missing elements such as:
<p>* a hundred images (from zero)
* more than a hundred new code examples, most of them unit tested (from very,
  very few)
* all signals (previously partially documented in the wiki)
* all theme variables
* the object properties
* references throughout the documentation
* variable types (previously mostly undocumented)
* many auto-generated pages instead of manually curated (and out of date) ones
<p>### The old wiki is closing down
<p>We are moving to a 2 tier solution based on official (and curated)
documentation, and a Git based wiki solution.
The old wiki has been partially closed down for years due to spam issues and
given the API breakage in the past, a non-negligible percentage of the content
and tips were no longer working properly.
<p>### New website address
<p>The official website is now <code>https://awesomewm.org/</code> and is now hosted by
GitHub. This will allow to retire the former server.
<p>### Awesome is now developed on GitHub
<p>This isn't technically part of the release and has been true for years, but as
the first major releases since the move, it is a good time to point out that we
retired the old infrastructure. This includes the bug tracker, download, wiki,
website, repository and continuous integration system.
<p>This move increased our development velocity, number of contributor,
visibility count and reduced our infrastructure maintenance cost.
<p>### Test-driven development
<p>Awesome went from 0% to 75% unit test coverage. We now have 4 testing systems:
<p>* Linting (checks the code quality and consistency)
* Unit testing
* Documentation examples, documentation images and user interface appearance
  tests
* Integration tests
<p>We also have a test matrix for:
<p>* Different Lua versions
* Different screen resolutions
* Installation paths
* Dependencies versions
<p>### Packaging support
<p>Apart from the existing packages in distributions, Awesome users can now use
"make package" to generate .deb or .rpm instead of using <code>make install</code>.


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->

<script defer type="text/javascript">
    const $nav = document.querySelector("#navigation");

    // When clicking the sidebar, open it
    $nav.addEventListener("click", function(ev) {
        if (document.body.clientWidth >= 768) {
            return;
        }

        const target = $nav;
        if (!target.classList.contains("open")) {
            target.classList.add("open");
            ev.stopPropagation();
        }
    });

    // When clicking anywhere else than the sidebar, close it
    document.querySelector("body").addEventListener("click", function(ev) {
        if (document.body.clientWidth >= 768 || ev.target.contains($nav)) {
            return;
        }

        const target = $nav;
        if (target.classList.contains("open")) {
            target.classList.remove("open");
        }
    });

    const copyResultClasses = {
        success : "copy-link--success",
        failure: "copy-link--failure"
    };

    const removeCopyResultClasses = ($target) =>
        Object.values(copyResultClasses).forEach(c => $target.classList.remove(c));

    document.querySelectorAll(".js-copy-link").forEach(copyLink => {
        copyLink.addEventListener("click", function(e) {
            e.preventDefault();
            const $target = e.target;

            removeCopyResultClasses($target);

            let link = $target.href;
            if (!link) {
                return;
            }
            if (link.startsWith("#")) {
                const curr = window.location.pathname;
                link = curr.substring(0, curr.indexOf("#")) + link;
            }

            // We need to create a fake element to copy the text from
            const fakeElement = document.createElement("textarea");
            fakeElement.value = link;
            document.body.appendChild(fakeElement);
            fakeElement.select();

            let success = false;
            try {
                success = document.execCommand("copy");
            } catch(err) {
                success = false;
            }

            fakeElement.remove();
            $target.classList.add(success ? copyResultClasses.success : copyResultClasses.failure);
            setInterval(() => removeCopyResultClasses($target), 1500);
        });
    });
</script>

</body>
</html>
